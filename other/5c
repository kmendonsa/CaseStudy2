######## 5C #############
install.packages("compare")
library(compare)

# Create a data frame for country and GPmean 
proc_dp <- subset(HDIMerged, select = c(Country, DPMean, Category ))

# Split apply combine the mean for each country 
proc_dp_mean <- ddply(proc_dp, .(Country), summarise, mean.DPMean = mean(DPMean))

#Is it numeric?
class(proc_gp_mean$mean.GPMean)

# Order the dataframe by GP mean 
proc_order_dp <- proc_dp_mean[order(proc_dp_mean$mean.DPMean, decreasing = TRUE), ]

# Create a frame with the top 15 entries 
proc_dp_top_15 <- head(proc_order_dp, n = 15)

# Plot a bar chart for the top 15 countries by GP mean 
ggplot(data=proc_dp_top_15, aes(x=Country, y=mean.DPMean)) +
  geom_bar(stat="identity", fill="steelblue")+
  labs(x='Country',
       y= 'DP Mean',
       title= 'Top 15 countries by DP Mean') + 
  theme(axis.text.x =
          element_text(size  = 5,
                       angle = 0,
                       hjust = 1,
                       vjust = 1),
        axis.text.y =
          element_text(hjust = 0.5),
        panel.background = element_blank(),
        panel.grid.minor = element_blank(),
        axis.ticks  = element_blank(),
        axis.line   = element_line(colour=NA),
        axis.line.x = element_line(colour="grey80"))

# The countries that are in the top 15 for GP and DP are

Taiwan
Sri Lanka
Qatar
Puerto Rico
Panama
Macao
Lithuania
Kazakhstan
Jamaica
Estonia
Ecuador
Colombia
Bulgaria
Brunei
Austria
