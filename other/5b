# Create a data frame for country and GPmean 
proc_gp <- subset(procrastinate, select = c(Country, GPMean))

# Split apply combine the mean for each country 
proc_gp_mean <- ddply(proc_gp, .(Country), summarise, mean.GPMean = mean(GPMean))

#Is it numeric?
class(proc_gp_mean$mean.GPMean)

# Order the dataframe by GP mean 
proc_order_gp <- proc_gp_mean[order(proc_gp_mean$mean.GPMean, decreasing = TRUE), ]

# Create a frame with the top 15 entries 
proc_gp_top_15 <- head(proc_order_gp, n = 15)

# Plot a bar chart for the top 15 countries by GP mean 
ggplot(data=proc_gp_top_15, aes(x=Country, y=mean.GPMean)) +
  geom_bar(stat="identity", fill="steelblue")+
  labs(x='Country',
       y= 'GP Mean',
       title= 'Top 15 countries by GP Mean') + 
  theme(axis.text.x =
          element_text(size  = 5,
                       angle = 0,
                       hjust = 1,
                       vjust = 1),
        axis.text.y =
          element_text(hjust = 0.5),
        panel.background = element_blank(),
        panel.grid.minor = element_blank(),
        axis.ticks  = element_blank(),
        axis.line   = element_line(colour=NA),
        axis.line.x = element_line(colour="grey80"))
